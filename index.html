<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>

<link rel="manifest" href="manifest.json">

<script>
if ("serviceWorker" in navigator) {
 navigator.serviceWorker.register("./service-worker.js");
}
</script>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… â€” Ø­ÙØµ</title>
<style>
body{
 margin:0;
 background:#0b1220;
 color:#fff;
 font-family:system-ui;
 transition:.4s;
}

/* ÙˆØ¶Ø¹ ÙØ§ØªØ­ */
body.light{
 background:#f5f7fb;
 color:#111;
}
body.light header{background:#e5e7eb;color:#111}
body.light .ayah-box{background:#fff}
body.light .search input{background:#fff;color:#111}
body.light .drawer{background:#f1f5f9}

/* HEADER */
header{
 background:#0f172a;
 padding:8px;
 text-align:center;
 font-weight:bold;
 font-size:14px;
}

/* SEARCH */
.search{text-align:center;padding:6px;}
.search input{
 width:80%;
 padding:7px;
 border-radius:12px;
 border:none;
 background:#020617;
 color:#fff;
 font-size:13px;
}

/* AYAH */
.ayah-box{
 margin:6px;
 padding:8px;
 border-radius:12px;
 background:#111827;
 text-align:center;
 font-size:14px;
}

/* VIEWER */
.viewer{
 display:flex;
 justify-content:center;
 padding:12px;
 max-height:70vh;
 background:#fff; /* Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ø¨Ø§Ù‡ØªØ© */
 border-radius:18px;
}
.viewer.fit img{width:100%;}

/* Ø§Ù„ØµÙˆØ±Ø© */
img{
 max-width:100%;
 border-radius:14px;
 background:#fff;
 transition:.4s;
 filter:none; /* Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙÙ„Ø§ØªØ± */
}

/* SIDE ARROWS */
.side{
 position:fixed;
 top:50%;
 transform:translateY(-50%);
 background:linear-gradient(145deg,#e5e7eb,#9ca3af);
 color:#111;
 border:none;
 padding:6px 7px;
 border-radius:50%;
 font-size:11px;
 box-shadow:0 0 8px rgba(255,255,255,.6);
 z-index:5;
}
.left{left:5px;}
.right{right:5px;}

/* NAV */
.nav{
 display:flex;
 gap:6px;
 padding:6px;
}
.nav button{
 flex:1;
 padding:6px;
 border:none;
 border-radius:12px;
 font-size:12px;
 background:linear-gradient(145deg,#e5e7eb,#9ca3af);
 color:#111;
 box-shadow:0 0 6px rgba(255,255,255,.5);
 animation:pulse 5s infinite;
}

/* ØªØ£Ø«ÙŠØ± Ù‡Ø§Ø¯Ø¦ */
@keyframes pulse{
 0%{filter:hue-rotate(0deg)}
 50%{filter:hue-rotate(30deg)}
 100%{filter:hue-rotate(0deg)}
}

/* DRAWER */
.drawer{
 position:fixed;
 top:0;
 right:-200px;
 width:190px;
 height:100%;
 background:#020617;
 transition:.3s;
 padding:8px;
 overflow:auto;
 z-index:10;
}
.drawer.open{right:0;}

.page-row{
 display:flex;
 gap:4px;
 margin-bottom:4px;
}
.page-row button{
 padding:5px;
 border:none;
 border-radius:8px;
 background:#1f2933;
 color:#fff;
 font-size:11px;
}

/* TOAST */
.toast{
 position:fixed;
 bottom:20px;
 left:50%;
 transform:translateX(-50%);
 background:#111827;
 padding:10px 14px;
 border-radius:12px;
 display:none;
 font-size:13px;
}

/* Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„Ù†Øµ (Ù†Ø³Ø®Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù„ÙƒÙ„ Ø§Ù„Ø´Ø§Ø´Ø§Øª) */
.ayah-box{
 animation:textGlow 6s infinite alternate;
}

/* Ø¥Ø·Ø§Ø± Ø§Ù„Ù…ØµØ­Ù */
img{
 animation:frameGlow 12s infinite alternate;
}

/* ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†Øµ â€“ Ø­Ù‚ÙŠÙ‚ÙŠ */
@keyframes textGlow{
 0%{
  background:linear-gradient(to right,#fff7cc,#fff,#ffe9a6);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  filter:drop-shadow(0 0 4px #ffd700);
 }
 50%{
  background:linear-gradient(to right,#e0ffff,#fff,#ccffff);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  filter:drop-shadow(0 0 6px #00ffff);
 }
 100%{
  background:linear-gradient(to right,#fff7cc,#fff,#ffe9a6);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  filter:drop-shadow(0 0 4px #ffd700);
 }
}

/* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¥Ø·Ø§Ø± */
@keyframes frameGlow{
 0%{filter:hue-rotate(0deg)}
 50%{filter:hue-rotate(40deg)}
 100%{filter:hue-rotate(0deg)}
}

/* ÙˆØ¶Ø¹ Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© */
.full header,
.full .search,
.full .ayah-box,
.full .nav{
 display:none !important;
}

.full .viewer{
 max-height:100vh;
 width:100vw;
 padding:0;
 background:#000;
}

.full img{
 max-height:100vh;
 width:auto;
 animation:frameGlow 8s infinite alternate;
}

/* ØªØ­Ø³ÙŠÙ† Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙØ§ØªØ­ */
body.light .viewer{
 background:#fff;
}
body.light img{
 filter:none;
}

/* Ø¯Ø¹Ù… Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø¶Ø¹ÙŠÙØ© */
@media (max-device-width:480px){
 .ayah-box{
  filter:drop-shadow(0 0 4px #fff)
         drop-shadow(0 0 8px #ffd700);
 }
}

/* Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø· Ù„Ù„Ù†Øµ */
.glow-text{
 color:#fff;
 background:linear-gradient(to right,#fff7cc,#fff,#ffe9a6);
 -webkit-background-clip:text;
 -webkit-text-fill-color:transparent;
 filter: drop-shadow(0 0 4px #ffd700)
         drop-shadow(0 0 8px #ffecb5);
}
 /* ØªØ¹Ø²ÙŠØ² Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ù„Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø¶Ø¹ÙŠÙØ© */
@media (max-device-width:480px){

 .viewer img{
  filter:
   brightness(1.35)
   contrast(1.45)
   saturate(1.25)
   drop-shadow(0 0 1px #fff)
   drop-shadow(0 0 2px #fff)
   drop-shadow(0 0 4px #ffd700);
 }

}

/* ÙˆØ¶Ø¹ ØªØ¹Ø²ÙŠØ² ÙŠØ¯ÙˆÙŠ Ù„Ùˆ Ø­Ø¨ÙŠØª */
.enhance img{
 filter:
  brightness(1.4)
  contrast(1.5)
  saturate(1.3)
  drop-shadow(0 0 1px #fff)
  drop-shadow(0 0 3px #ffd700)
  drop-shadow(0 0 6px #ffea8a);
}
 
</style>
 
</head>

<body>
 
<div id="consentBox" style="
position:fixed;
top:0;left:0;
width:100%;height:100%;
background:rgba(0,0,0,.85);
display:flex;
align-items:center;
justify-content:center;
z-index:9999;
">

<div style="
background:#111827;
padding:20px;
border-radius:16px;
max-width:90%;
text-align:center;
color:white;
font-size:14px;
">

<b>ğŸŒ™ Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</b><br><br>

Ù†Ø³Ø£Ù„ Ø§Ù„Ù„Ù‡ Ù„Ùƒ Ø§Ù„ØªÙˆÙÙŠÙ‚ ÙˆØ§Ù„Ø¨Ø±ÙƒØ© ğŸ¤  
Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„Ø§ ÙŠØ¬Ù…Ø¹ Ø£ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ø´Ø®ØµÙŠØ© Ø¥Ø·Ù„Ø§Ù‚Ø§Ù‹.

Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙÙ‚Ø· Ù„ØªØ°ÙƒÙŠØ±Ùƒ
Ø¨ÙˆØ±ÙØ¯ Ø§Ù„Ù‚Ø±Ø¢Ù† ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø°ÙŠ ØªØ­Ø¯Ø¯Ù‡ Ø£Ù†Øª.

<br><br>
Ù‡Ù„ ØªØ³Ù…Ø­ Ø¨ØªÙØ¹ÙŠÙ„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…Ù†Ø¨Ù‡ØŸ

<br><br>

<button onclick="acceptConsent()"
style="padding:10px 16px;border:none;border-radius:12px;
background:#22c55e;color:white;font-size:13px">
Ù…ÙˆØ§ÙÙ‚ ğŸ¤
</button>

<button onclick="Ø±ÙØ¶()"
style="padding:10px 16px;border:none;border-radius:12px;
background:#ef4444;color:white;font-size:13px;margin-right:6px">
Ø±ÙØ¶
</button>

<br><br>
<small>
Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©:  
Ù„Ø§ ÙŠØªÙ… Ø¬Ù…Ø¹ Ø£Ùˆ ØªØ®Ø²ÙŠÙ† Ø£ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª.
ÙƒÙ„ Ø´ÙŠØ¡ Ù…Ø­ÙÙˆØ¸ Ù…Ø­Ù„ÙŠØ§Ù‹ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ ÙÙ‚Ø·.
</small>

</div>
</div>
 
<header>Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… â€” Ø­ÙØµ</header>

<div class="search">
 <input id="search" placeholder="Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø©">
</div>
 
<div class="ayah-box glow-text" id="ayah"></div>
 
<div class="viewer" id="viewer">
 <img id="img">
</div>

<!-- Ø§Ù„Ø£Ø³Ù‡Ù… -->
<button class="side left" onclick="prev()">â®</button>
<button class="side right" onclick="next()">â¯</button>

<div class="nav">
 <button onclick="toggleDrawer()">â˜°</button>
 <button onclick="toggleFull()">â¤¢</button>
 <button onclick="toggleMode()">â—</button>
</div>

<div class="nav">
 <input type="time" id="alarm" style="flex:1;padding:6px;border-radius:10px;border:none;font-size:12px">
 <button onclick="setAlarm()">â°</button>
</div>

<div class="drawer" id="drawer"></div>
<div class="toast" id="toast"></div>

<!-- Ù…Ù„Ù Ø§Ù„ØµÙˆØª Ù…Ù† Ø§Ù„Ø¬Ø°Ø± -->
<audio id="ring" src="alarm.mp3"></audio>

<script>
 /* Ø·Ù„Ø¨ Ø¥Ø°Ù† Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª */
if ("Notification" in window) {
 if (Notification.permission !== "granted") {
  Notification.requestPermission();
 }
}

/* Ø¥Ø´Ø¹Ø§Ø± Ø®Ø§Ø±Ø¬ÙŠ */
function notifyExternal(){

 if(localStorage.consent!=="yes") return;

 if("Notification" in window &&
    Notification.permission==="granted"){

  new Notification("ØªØ°ÙƒÙŠØ± Ø§Ù„Ù‚Ø±Ø¢Ù†",{
   body:"Ø­Ø§Ù† ÙˆÙ‚Øª Ø§Ù„ØªÙ„Ø§ÙˆØ© ğŸŒ™",
   icon:"quran-512.png"
  });

  /* Ø§Ù‡ØªØ²Ø§Ø² */
  if(navigator.vibrate){
   navigator.vibrate([300,150,300,150,500]);
  }
 }
}
 
 
const TOTAL=604;
let page=parseInt(localStorage.page||1);
let full=false;
let fit=false;
let sx;

const img=document.getElementById("img");
const viewer=document.getElementById("viewer");
const drawer=document.getElementById("drawer");
const ring=document.getElementById("ring");
const toast=document.getElementById("toast");

/* LOAD */
function load(){
 img.src=page+".png";
 localStorage.page=page;
}
load();

/* ØªÙ†Ù‚Ù„ */
function prev(){if(page>1){page--;load();}}
function next(){if(page<TOTAL){page++;load();}}

/* Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ */
if(localStorage.mode=="light")
 document.body.classList.add("light");

function toggleMode(){
 document.body.classList.toggle("light");
 localStorage.mode=
 document.body.classList.contains("light")?"light":"dark";
}

/* Ø¯Ø±Ø¬ Ø§Ù„ÙÙ‡Ø±Ø³ */
function toggleDrawer(){
 drawer.classList.toggle("open");
}

/* Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙÙ‡Ø±Ø³ */
for(let i=1;i<=TOTAL;i++){
 let row=document.createElement("div");
 row.className="page-row";

 let b=document.createElement("button");
 b.textContent=i;
 b.style.flex="1";
 b.onclick=()=>{page=i;load();drawer.classList.remove("open");};

 let s=document.createElement("button");
 s.textContent="â˜…";
 s.style.width="26px";
 s.onclick=()=>{
  localStorage["fav"+i]=true;
  showToast("ØªÙ… Ø­ÙØ¸ "+i);
 };

 row.append(b,s);
 drawer.appendChild(row);
}

/* Ø§Ù„Ø¨Ø­Ø« */
search.onchange=()=>{
 let n=parseInt(search.value);
 if(n>=1 && n<=TOTAL){page=n;load();}
};

/* Ø§Ù„Ø³Ø­Ø¨ */
img.addEventListener("touchstart",e=>{
 sx=e.touches[0].clientX;
});
img.addEventListener("touchend",e=>{
 let dx=e.changedTouches[0].clientX-sx;
 if(dx>80) next();
 if(dx<-80) prev();
});

/* Ø§Ù„Ù†Ù‚Ø± Ù…Ø±ØªÙŠÙ† Ù„Ù„ØªÙƒØ¨ÙŠØ± */
let lastTap = 0;
let scale = 1;

/* Ø¯Ø§Ù„Ø© Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© */
function toggleFullscreen(){
 if(!document.fullscreenElement){
  document.body.classList.add("full");
  document.documentElement.requestFullscreen();
 }else{
  document.body.classList.remove("full");
  document.exitFullscreen();
 }
}

/* Ù…Ø§ÙˆØ³ */
img.addEventListener("dblclick",toggleFullscreen);

/* Ù„Ù…Ø³ */
img.addEventListener("touchend",e=>{
 let now = Date.now();
 if(now - lastTap < 300){
  toggleFullscreen();
 }
 lastTap = now;
});

/* ØªÙƒØ¨ÙŠØ± ÙˆØªØµØºÙŠØ± Ø¨Ø§Ù„Ù„Ù…Ø³ Ø¯Ø§Ø®Ù„ fullscreen */
img.addEventListener("wheel",e=>{
 if(!document.fullscreenElement) return;
 e.preventDefault();
 scale += e.deltaY * -0.001;
 scale = Math.min(Math.max(.8,scale),3);
 img.style.transform=`scale(${scale})`;
});

/* Ù„Ù…Ø³ Ø¨Ø¥ØµØ¨Ø¹ÙŠÙ† (pinch zoom) */
let startDist=0;

img.addEventListener("touchstart",e=>{
 if(e.touches.length==2){
  startDist=Math.hypot(
   e.touches[0].pageX-e.touches[1].pageX,
   e.touches[0].pageY-e.touches[1].pageY
  );
 }
});

img.addEventListener("touchmove",e=>{
 if(e.touches.length==2 && document.fullscreenElement){
  let newDist=Math.hypot(
   e.touches[0].pageX-e.touches[1].pageX,
   e.touches[0].pageY-e.touches[1].pageY
  );
  scale*=newDist/startDist;
  scale=Math.min(Math.max(.8,scale),3);
  img.style.transform=`scale(${scale})`;
  startDist=newDist;
 }
});
  

/* Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© */
function toggleFull(){
 if(!full){
  document.body.classList.add("full");
  document.documentElement.requestFullscreen();
  full=true;
 }else{
  document.body.classList.remove("full");
  document.exitFullscreen();
  full=false;
 }
}

/* Ø¢ÙŠØ§Øª */
const ayat=[
 "Ù‚ÙÙ„Ù’ Ø¥ÙÙ†Ù‘ÙÙ…ÙØ§ Ø£ÙÙ…ÙØ±Ù’ØªÙ Ø£ÙÙ†Ù’ Ø£ÙØ¹Ù’Ø¨ÙØ¯Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù",
 "ÙƒÙÙ†Ù’ØªÙÙ…Ù’ Ø®ÙÙŠÙ’Ø±Ù Ø£ÙÙ…Ù‘ÙØ©Ù",
 "ÙˆÙÙ„ÙÙ†ÙØ§ Ø£ÙØ¹Ù’Ù…ÙØ§Ù„ÙÙ†ÙØ§",
 "Ø¥ÙÙ†Ù‘Ù Ù…ÙØ¹Ù Ø§Ù„Ù’Ø¹ÙØ³Ù’Ø±Ù ÙŠÙØ³Ù’Ø±Ù‹Ø§",
 "ÙˆÙÙ‚ÙÙ„Ù’ Ø±ÙØ¨Ù‘Ù Ø²ÙØ¯Ù’Ù†ÙÙŠ Ø¹ÙÙ„Ù’Ù…Ù‹Ø§"
];
let ai=0;
function rotate(){
 ayah.textContent=ayat[ai%ayat.length];
 ai++;
}
rotate();
setInterval(rotate,15000);

/* Ø§Ù„Ù…Ù†Ø¨Ù‡ */
function setAlarm(){
 localStorage.alarm=alarm.value;
 showToast("ØªÙ… Ø¶Ø¨Ø· Ø§Ù„Ù…Ù†Ø¨Ù‡");
}
setInterval(()=>{
 let t=localStorage.alarm;
 if(!t)return;

 let n=new Date();
 let cur=n.getHours().toString().padStart(2,"0")+":"+n.getMinutes().toString().padStart(2,"0");

 if(cur==t){
 ring.play();          // ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª
 notifyExternal();    // Ø¥Ø´Ø¹Ø§Ø± Ø®Ø§Ø±Ø¬ÙŠ
 showToast("ğŸ“– Ø­Ø§Ù† ÙˆÙ‚Øª Ø§Ù„ØªÙ„Ø§ÙˆØ©");
 localStorage.alarm="";
}
},60000);

/* ØªÙ†Ø¨ÙŠÙ‡ */
function showToast(msg){
 toast.textContent=msg;
 toast.style.display="block";
 setTimeout(()=>toast.style.display="none",3500);
}
 /* Ø¥Ø¸Ù‡Ø§Ø± Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø£ÙˆÙ„ Ù…Ø±Ø© */
if(!localStorage.consent){
 document.getElementById("consentBox").style.display="flex";
}else{
 document.getElementById("consentBox").style.display="none";
}

/* Ù‚Ø¨ÙˆÙ„ */
function acceptConsent(){
 localStorage.consent="yes";
 document.getElementById("consentBox").style.display="none";

 if("Notification" in window){
  Notification.requestPermission();
 }
}

/* Ø±ÙØ¶ */
function Ø±ÙØ¶(){
 localStorage.consent="no";
 document.getElementById("consentBox").style.display="none";
}
 
</script>

</body>
</html>
